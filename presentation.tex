\documentclass[11pt,compress]{beamer}

\RequirePackage[francais]{babel}
\RequirePackage{amsfonts,amssymb,amsmath,mathtools}
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage{lmodern}
\RequirePackage{mathpazo}
\usepackage{tikz}

\definecolor{LHCblue}{RGB}{10, 73, 132}
\usecolortheme[named=LHCblue]{structure}
\usepackage[bars]{beamerthemetree} %Beamer theme v 2.2
\usefonttheme[onlymath]{serif}
%\usepackage{kerkis}
\setbeamercovered{highly dynamic}
\usetheme{Ilmenau} % Beamer theme v 3.0
\useoutertheme[subsection=true]{smoothbars}%Beamer Outer Theme-circles on top
\usefonttheme{serif}
\useinnertheme{circles} %rectangle bullet points instead of circle ones
\usepackage{beamerthemebars}

\setbeamerfont{section in toc}{size=\small}
\setbeamerfont{subsection in toc}{size=\small}
\setbeamercolor{subsection in toc}{fg=LHCblue!40!black}
\expandafter\def\expandafter\insertshorttitle\expandafter{%
  \insertshorttitle\hfill%
  \insertframenumber\,/\,\inserttotalframenumber}
\setbeamertemplate{navigation symbols}{}%remove navigation symbols

\AtBeginSection[]
{
  \begin{frame}
  \frametitle{Plan}
  \begin{columns}[t]
  \begin{column}{5cm}
  \tableofcontents[sections={1-3},currentsection, hideothersubsections]
  \end{column}
  \begin{column}{5cm}
  \tableofcontents[sections={4-6},currentsection,hideothersubsections]
  \end{column}
  \end{columns}
  \end{frame}
}

\author{Cl√©ment PARISOT}
\title{Young engineers seminar}
\subtitle{Grid'5000 support and services orchestration}
\institute{IJD INRIA Nancy\\MADYNES Team\vspace{2.75cm}}
\begin{document}
\titlegraphic{%
\begin{center}
\includegraphics[height=1.25cm]{figures/inria-logo}
\hspace{30mm}
\includegraphics[height=1.25cm]{figures/g5k-logo}
\end{center}
}
\date{\scriptsize 2016/11/09}

{
\setbeamertemplate{footline}{} 
\setbeamertemplate{headline}{}
\usebackgroundtemplate{
  \begin{tikzpicture}
    \path [outer color = LHCblue!15, inner color = white]
      (0,0) rectangle (\paperwidth,\paperheight);
  \end{tikzpicture}}
\begin{frame}[plain]
  \titlepage
\end{frame}
}
\addtocounter{framenumber}{-1}
\institute{IJD INRIA Nancy}

\begin{frame}
\frametitle{Summary}
\begin{columns}[t]
  \begin{column}{5cm}
  \tableofcontents[sections={1-3},hideothersubsections]
  \end{column}
  \begin{column}{5cm}
  \tableofcontents[sections={4-6},hideothersubsections]
  \end{column}
  \end{columns}
\end{frame}

\section{Introduction}
\subsection{Grid'5000}
\begin{frame}
\frametitle{Grid'5000 platform}
\begin{block}{}
\textbf{Grid'5000}: a large-scale and versatile distributed testbed for experiments-driven research on parallel and distributed systems
\end{block}
\begin{itemize}
\item Created in 2003
\item Need of a bigger and efficient platform for experiments

\item Give users root access to the compute nodes
\item Deploy environment
\item Allows experiments on all the software layers
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Grid'5000 today (2016/11)}
\begin{columns}[c]
  \begin{column}{6cm}
	\begin{itemize}
	\item 7 sites in France
	\item 1 site in Luxembourg
	\item 10G dedicated Renater network
	\item 30 clusters
	\item 903 nodes
	\item 8700 cores
	\item 84 accelerators (Xeon Phi/GPU)
	\item 1076 users over the last 3 years
	\end{itemize}
  \end{column}
  \begin{column}{6cm}
	\includegraphics[scale=0.42]{figures/Renater5-g5k}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Grid'5000 today (2016/11)}
\begin{center}
\includegraphics[scale=0.19]{figures/sunburst}
\end{center}
\end{frame}

\section{Support}
\subsection{Monitoring services and alerts}
\begin{frame}
\frametitle{Nagios dashboard}
\begin{center}
\includegraphics[scale=0.29]{figures/nagios}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Nagios overview}
\begin{itemize}
\item Monitoring of the infrastructure
\item Alerts on load, ping, Hard disk failure, ...
\item One server per site
\item Reporting by mail 
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Icinga dashboard}
\begin{center}
\includegraphics[scale=0.30]{figures/icinga}
\end{center}
\end{frame}

\begin{frame}
\frametitle{Icinga overview}
\begin{itemize}
\item Better UI
\item Unified dashboard for global view
\item Compatibility with Nagios (old) checks
\item Distributed monitoring
\end{itemize}
\end{frame}

\subsection{Incident and ticket}
\begin{frame}
\frametitle{Bugzilla: different sorts of ticket}
\begin{itemize}
\item Incident reaction (network broken, services down...)
\item Event on Grid'5000 (maintenance, update...)
\item Problem with a node, environment or software
\item Feature request
\item Daily task (projet management)
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Bugzilla: how to fill a ticket}
\begin{itemize}
\item Component: a site, an internal/external service, network, documentation ?
\item Severity: high, medium, low, to discuss
\item Assignee: person in charge of the resolution
\item Status: New, Assigned, Resolved
\item Keywords: event, incident, task of a project
\end{itemize}
\end{frame}

\section{Services orchestration}
\subsection{Xen/Puppet4}
\begin{frame}
\frametitle{Virtualisation of services infrastructure with Xen}
\begin{itemize}
\item 1 VM (domU) for each service
\begin{itemize}
\item Supervision
\item DNS
\item mediawiki
\end{itemize}
\item 1 to 3 hypervisor (dom0) per site
\item Filesystem: lvm and ext4
\item OS: Debian (lenny, squeeze, wheezy and jessie)
\item No manager to create, destroy or migrate the VM (Xen CLI) 
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Puppet for services management}
\begin{itemize}
\item Configuration management
\item Model-driven approach
\item 1 module for each application (nagios, bugzilla, apache, ...)
\item Puppet run on all the VM and configure:
\begin{itemize}
\item Files (content, owner, rights...)
\item Packages (present, absent, version, ...)
\item Services (running, stopped)
\end{itemize}
\end{itemize}
\end{frame}

\section{Example: Mediawiki upgrade}
\subsection{Package creation}
\begin{frame}
\frametitle{How to upgrade mediawiki}
\begin{itemize}
\item Upgrade version of: mysql, php
\item Read release notes
\item Dump existing DB files (backup)
\item Upload tarball and untar
\item Adapt LocalSettings.php file
\item Change rights/owner on images directory
\item Run the upgrade script
\end{itemize}
%\end{block}
\end{frame}

\begin{frame}
\frametitle{Create a Debian package for mediawiki}
\begin{itemize}
\item Untar the mediawiki to the correct location
\item Just add dependances to packages and their versions in the debian control file
\item Add a postinstall script to change the right/owner on images directory
\item Eventually run the upgrade script at the end
\item Specify the version installed by this package
\end{itemize}
\begin{block}{}
Debian will manage the dependances of packages to install and their version for us
\end{block}
\end{frame}

\subsection{Vagrant}
\begin{frame}
\frametitle{Vagrant as a testing environment}
\end{frame}

\subsection{Upgrade in production}
\begin{frame}
\frametitle{Tests in production}
\end{frame}

\section{Conclusion}
\begin{frame}
\frametitle{Conclusion}
:)
\end{frame}

\section*{}
\begin{frame}
\frametitle{Sources}

\end{frame}
\end{document}
